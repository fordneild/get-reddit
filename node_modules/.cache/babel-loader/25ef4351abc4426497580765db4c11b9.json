{"ast":null,"code":"import fetchData from \"./useFetch\";\nimport LocalStorage from \"./LocalStorage\";\nimport defaultSubreddits from \"../assets/defaultSubreddits\";\n\nconst fetchSubPosts = async subName => {\n  const sub = await fetchData(`https://www.reddit.com/r/${subName}/.json?`);\n  return sub.data.children.filter(post => {\n    try {\n      return post.data.post_hint === \"image\";\n    } catch (e) {\n      return false;\n    }\n  }).map(post => {\n    return {\n      url: post.data.url,\n      pipe: `r/${post.data.subreddit}`\n    };\n  });\n};\n\nconst loadSubredditPosts = async () => {\n  const subsLS = await LocalStorage.get(\"reddit\");\n  console.log(subsLS);\n  const subs = subsLS !== undefined ? subsLS : defaultSubreddits;\n  console.log(subs);\n  const redditPosts = await Promise.all(subs.map(async sub => {\n    return await fetchSubPosts(sub);\n  }));\n  const flatPosts = [].concat(...redditPosts);\n  return flatPosts;\n};\n\nexport default loadSubredditPosts;","map":{"version":3,"sources":["/Users/fordneild/workdir/get-reddit/src/Services/redditFetch.js"],"names":["fetchData","LocalStorage","defaultSubreddits","fetchSubPosts","subName","sub","data","children","filter","post","post_hint","e","map","url","pipe","subreddit","loadSubredditPosts","subsLS","get","console","log","subs","undefined","redditPosts","Promise","all","flatPosts","concat"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,YAAtB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,OAAOC,iBAAP,MAA8B,6BAA9B;;AAEA,MAAMC,aAAa,GAAG,MAAMC,OAAN,IAAiB;AACrC,QAAMC,GAAG,GAAG,MAAML,SAAS,CAAE,4BAA2BI,OAAQ,SAArC,CAA3B;AACA,SAAOC,GAAG,CAACC,IAAJ,CAASC,QAAT,CACJC,MADI,CACGC,IAAI,IAAI;AACd,QAAI;AACF,aAAOA,IAAI,CAACH,IAAL,CAAUI,SAAV,KAAwB,OAA/B;AACD,KAFD,CAEE,OAAOC,CAAP,EAAU;AACV,aAAO,KAAP;AACD;AACF,GAPI,EAQJC,GARI,CAQAH,IAAI,IAAI;AACX,WAAO;AACLI,MAAAA,GAAG,EAAEJ,IAAI,CAACH,IAAL,CAAUO,GADV;AAELC,MAAAA,IAAI,EAAG,KAAIL,IAAI,CAACH,IAAL,CAAUS,SAAU;AAF1B,KAAP;AAID,GAbI,CAAP;AAcD,CAhBD;;AAkBA,MAAMC,kBAAkB,GAAG,YAAY;AACrC,QAAMC,MAAM,GAAG,MAAMhB,YAAY,CAACiB,GAAb,CAAiB,QAAjB,CAArB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYH,MAAZ;AACA,QAAMI,IAAI,GAAIJ,MAAM,KAAIK,SAAV,GAAsBL,MAAtB,GAA8Bf,iBAA5C;AACAiB,EAAAA,OAAO,CAACC,GAAR,CAAYC,IAAZ;AACA,QAAME,WAAW,GAAG,MAAMC,OAAO,CAACC,GAAR,CACxBJ,IAAI,CAACT,GAAL,CAAS,MAAMP,GAAN,IAAa;AACpB,WAAO,MAAMF,aAAa,CAACE,GAAD,CAA1B;AACD,GAFD,CADwB,CAA1B;AAKA,QAAMqB,SAAS,GAAG,GAAGC,MAAH,CAAU,GAAGJ,WAAb,CAAlB;AACA,SAAOG,SAAP;AACD,CAZD;;AAcA,eAAeV,kBAAf","sourcesContent":["import fetchData from \"./useFetch\";\nimport LocalStorage from \"./LocalStorage\";\nimport defaultSubreddits from \"../assets/defaultSubreddits\";\n\nconst fetchSubPosts = async subName => {\n  const sub = await fetchData(`https://www.reddit.com/r/${subName}/.json?`);\n  return sub.data.children\n    .filter(post => {\n      try {\n        return post.data.post_hint === \"image\";\n      } catch (e) {\n        return false;\n      }\n    })\n    .map(post => {\n      return {\n        url: post.data.url,\n        pipe: `r/${post.data.subreddit}`\n      };\n    });\n};\n\nconst loadSubredditPosts = async () => {\n  const subsLS = await LocalStorage.get(\"reddit\");\n  console.log(subsLS)\n  const subs = (subsLS !==undefined?  subsLS: defaultSubreddits)\n  console.log(subs)\n  const redditPosts = await Promise.all(\n    subs.map(async sub => {\n      return await fetchSubPosts(sub);\n    })\n  );\n  const flatPosts = [].concat(...redditPosts);\n  return flatPosts;\n};\n\nexport default loadSubredditPosts;\n"]},"metadata":{},"sourceType":"module"}